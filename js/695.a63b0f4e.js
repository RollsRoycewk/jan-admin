"use strict";(self["webpackChunkjan_admin"]=self["webpackChunkjan_admin"]||[]).push([[695],{9790:function(e,t,n){n.d(t,{IC:function(){return a},IT:function(){return i},Z8:function(){return r},cQ:function(){return o},h8:function(){return s},n3:function(){return c}});const a=e=>({list:[{role:[{id:"1",title:"超级管理员"}],_id:"612710a0ec87aa543c9c341d",id:"0",openTime:"1433088000000",username:"super-admin",mobile:"188xxxx0001",avatar:"https://m.imooc.com/static/wap/static/common/img/logo-small@2x.png"},{role:[{id:"2",title:"管理员"}],_id:"612710a0ec87aa543c9c341e",id:"1",username:"admin",openTime:"1559318400000",mobile:"188xxxx0002",avatar:"https://img4.sycdn.imooc.com/61110c2b0001152907400741-140-140.jpg"}],total:7,page:"1",size:"2"}),o=e=>null,s=e=>!0,r=()=>({list:[{role:[{id:"1",title:"超级管理员"}],_id:"612710a0ec87aa543c9c341d",id:"0",openTime:"1433088000000",username:"super-admin",mobile:"188xxxx0001",avatar:"https://m.imooc.com/static/wap/static/common/img/logo-small@2x.png"},{role:[{id:"2",title:"管理员"}],_id:"612710a0ec87aa543c9c341e",id:"1",username:"admin",openTime:"1559318400000",mobile:"188xxxx0002",avatar:"https://img4.sycdn.imooc.com/61110c2b0001152907400741-140-140.jpg"}],total:7,page:"1",size:"2"}),c=e=>({role:[{id:"1",title:"超级管理员"}],remark:["超级管理员","BOSS"],experience:[{startTime:"1538323200000",endTime:"1551369600000",title:"慕课网",desc:"混合开发京东商城"},{startTime:"1614528000000",endTime:"1625068800000",title:"慕课网",desc:"uni-app 开发企业级小程序"}],_id:"612710a0ec87aa543c9c341d",id:"0",openTime:"1433088000000",username:"super-admin",title:"超级管理员",mobile:"188xxxx0001",avatar:"https://m.imooc.com/static/wap/static/common/img/logo-small@2x.png",gender:"男",nationality:"汉",address:"北京市朝阳区xx大道 11xx0 号 3 层",major:"在线职业教育平台",glory:"国内领先的线上 IT 教育品牌"}),i=e=>[{title:"超级管理员"}]},9695:function(e,t,n){n.r(t),n.d(t,{default:function(){return j}});n(7658);var a=n(6252),o=n(2262),s=n(3577),r=n(9963),c=n(7869),i=n.n(c);const l=e=>{const t=[],n=i().utils.decode_range(e["!ref"]);let a;const o=n.s.r;for(a=n.s.c;a<=n.e.c;++a){const n=e[i().utils.encode_cell({c:a,r:o})];let s="UNKNOWN "+a;n&&n.t&&(s=i().utils.format_cell(n)),t.push(s)}return t},u=e=>/\.(xlsx|xls|csv)$/.test(e.name);var m=n(1348),p=n(5108);const d={class:"upload-excel"},x={class:"btn-upload"},g=["onDrop","onDragover","onDragenter"];var f={__name:"index",props:{beforeUpload:Function,onSuccess:Function},setup(e){const t=e,n=(0,o.iH)(!1),c=(0,o.iH)(null),f=()=>{c.value.click()},v=e=>{const t=e.target.files,n=t[0];n&&_(n)},_=e=>{if(c.value.value=null,!t.beforeUpload)return void h(e);const n=t.beforeUpload(e);n&&h(e)},h=e=>(n.value=!0,new Promise(((t,a)=>{const o=new FileReader;o.onload=e=>{const a=e.target.result,o=i().read(a,{type:"array"}),s=o.SheetNames[0],r=o.Sheets[s],c=l(r),u=i().utils.sheet_to_json(r);b({header:c,results:u}),n.value=!1,t()},o.readAsArrayBuffer(e)}))),b=e=>{t.onSuccess&&t.onSuccess(e)},T=e=>{if(p.log("eeeeee",e),n.value)return;const t=e.dataTransfer.files;if(1!==t.length)return m.z8.error("必须要有一个文件");const a=t[0];if(!u(a))return m.z8.error("文件必须是.xlsx,.xls,.csv格式"),!1;_(a)},y=e=>{e.dataTransfer.dropEffect="copy"};return(e,t)=>{const o=(0,a.up)("el-button"),i=(0,a.up)("svg-icon");return(0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",x,[(0,a.Wm)(o,{type:"primary",loading:n.value,onClick:f},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("msg.uploadExcel.upload")),1)])),_:1},8,["loading"])]),(0,a._)("input",{type:"file",ref_key:"excelUploadInput",ref:c,class:"excel-upload-input",accept:".xlsx,.xls",onChange:v},null,544),(0,a._)("div",{class:"drop",onDrop:(0,r.iM)(T,["stop","prevent"]),onDragover:(0,r.iM)(y,["stop","prevent"]),onDragenter:(0,r.iM)(y,["stop","prevent"])},[(0,a.Wm)(i,{icon:"link"}),(0,a._)("span",null,(0,s.zw)(e.$t("msg.uploadExcel.drop")),1)],40,g)])}}},v=n(3744);const _=(0,v.Z)(f,[["__scopeId","data-v-5f92e711"]]);var h=_;const b={"姓名":"username","联系方式":"mobile","角色":"role","开通时间":"openTime"},T=e=>{const t=new Date(24*(e-1)*36e5+1);t.setYear(t.getFullYear()-70);const n=t.getFullYear()+"",a=t.getMonth()+1+"",o=t.getDate()-1+"";return n+"-"+(a<10?"0"+a:a)+"-"+(o<10?"0"+o:o)};var y=n(9790),w=n(9150),k=n(2201),D={__name:"index",setup(e){const t=(0,w.QT)(),n=(0,k.tv)(),s=({header:e,results:a})=>{const o=r(a);(0,y.cQ)(o),m.z8.success({message:1+t.t("msg.excel.importSuccess"),type:"success"}),n.push("/user/manage")},r=e=>{const t=[];return e.forEach((e=>{const n={};Object.keys(e).forEach((t=>{"openTime"!==b[t]?n[b[t]]=e[t]:n[b[t]]=T(e[t])})),t.push(n)})),t};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)((0,o.SU)(h),{onSuccess:s})]))}};const S=D;var j=S}}]);
//# sourceMappingURL=695.a63b0f4e.js.map